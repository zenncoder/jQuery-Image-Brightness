"function"!=typeof Object.create&&(Object.create=function(a){function b(){}return b.prototype=a,new b}),function(a,b,c,d){var e={init:function(b,c,d){var e=this;"object"==typeof b?e.options=a.extend({},a.fn.imageBrightness.defaults,b):e.options=a.fn.imageBrightness.defaults,e.$element=a(c),e.imageSource=e.$element.attr("src"),e.imageFileName=e.getFilename(!1),e.imageDisplayValue=0,e.calculateBrightness(function(b){a("img.jQuery-image-brightness-delete-me").remove(),e.imageDisplayValue=e.getDisplayValue(b),d(e)})},getDisplayValue:function(a){var b=this;return b.options.reverseValue?displayValue=255-a:displayValue=a,displayValue},getFilename:function(a){var b=this,c=b.imageSource.replace(/\\/g,"/");return c=c.substring(c.lastIndexOf("/")+1),c=a?c.replace(/[?#].+$/,""):c.split(".")[0]},calculateBrightness:function(b){var d=this,e=c.createElement("img");a(e).attr({src:d.imageSource,"class":"jQuery-image-brightness-delete-me"}).hide(),c.body.appendChild(e);var f=0;e.onload=function(){var a=c.createElement("canvas");a.width=this.width,a.height=this.height;var d=a.getContext("2d");d.drawImage(this,0,0);for(var h,i,j,k,e=d.getImageData(0,0,a.width,a.height),g=e.data,l=0,m=g.length;m>l;l+=4)h=g[l],i=g[l+1],j=g[l+2],k=Math.floor((h+i+j)/3),f+=k;var n=Math.floor(f/(this.width*this.height));b(n)},e.onerror=function(){}}};a.fn.imageBrightness=function(a,b){return this.each(function(){var c=Object.create(e);c.init(a,this,function(a){"function"==typeof b&&b(a.$element,a.imageDisplayValue)})}),this},a.fn.imageBrightness.defaults={reverseValue:!1}}(jQuery,window,document);